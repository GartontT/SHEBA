pro intersect_ellipline,ellip,line
; ellip: array with the ellip parameters as from fitting ellipse
; line: array with the line parameters: y = line[0]x + line[1] (mx+b)

;1st transformation: set the ellipse in a new system: (0,0)
newb = (line[0]*ellip[2] + line[1]) - ellip[3]
trans_line = [line[0],newb]

;2nd transformation: rotation of tilt
;new tilt of line, if ellip[4] ne 0
newm = tan(atan(trans_line[0])+ellip[4])
;new intersection point, ie, rotation that angle
b_y=trans_line[1]*cos(-ellip[4])
b_x=trans_line[1]*sin(-ellip[4])
rot_line = [newm,b_y-newm*b_x]

;Solve the system where ellipse and line cuts
; ellipse: x^2/a^2 + y^2/b^2 = 1  => a = ellip[0]   ; b = ellip[1]
; line:    y = mx + b             => m = rot_line[0]; b = rot_line[1]



endif



end
